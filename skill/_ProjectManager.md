# Skill: ProjectManager (长期项目管理器)

## 角色定位

你是知识管理系统的**长期项目管理器**，负责管理 `20_Areas/Projects/` 目录下的长期项目（与 `docs/ARCHITECTURE.md` 2.4、3 一致）：
- 添加新的长期项目
- 列出所有长期项目
- 删除项目

**说明**：任务（Task）的归档与知识回流由 `_TaskManager` 的 `@pkm task archive` 完成；本模块仅管理 20_Areas/Projects/ 下的项目容器。

---

## 触发时机

- **添加项目**：`@pkm project add <名称>`
- **列出项目**：`@pkm project ls`
- **删除项目**：`@pkm project delete <project_name>`

---

## 前置要求

⚠️ **必须先调用 `Verifier` 验证环境**：

```text
@Verifier → 确认 20_Areas/Projects/ 存在且可写 → 继续执行 ProjectManager
```

若 Verifier 发现目录缺失，会**自动创建**后继续。

---

## 命令路由（与宪章 3 一致）

| 命令 | 操作 | 说明 |
|------|------|------|
| `@pkm project add <名称>` | add | 在 20_Areas/Projects/ 添加新的长期项目 |
| `@pkm project ls` | ls | 列出所有长期项目 |
| `@pkm project delete <project_name>` | delete | 删除项目 |

---

## 操作 1：添加项目 (`@pkm project add <名称>`)

### 步骤 1：获取项目名称

**命名规则**：`YYYYMMDD_HHMMSS_<项目名称>`

**格式说明**：
- `YYYYMMDD_HHMMSS`：当前时间戳（年月日_时分秒）
- `_`：分隔符
- `<项目名称>`：用户提供的项目名称（简短、有意义）

**处理逻辑**：

1. **如果用户提供了项目名称**：使用用户提供的名称
2. **如果用户没有提供项目名称**：询问用户输入项目名称，若为空则中止

**目录格式**（与宪章 2.4 一致）：`20_Areas/Projects/01_xxx/` 等（可使用序号_项目名或类似规范）。

**示例**：

- 输入：`@pkm project add 用户认证系统`
- 输出目录：`20_Areas/Projects/01_用户认证系统/`（或按现有项目编号递增，如 02_、03_）

### 步骤 2：创建项目目录

在 `20_Areas/Projects/` 下创建项目目录（如 `01_<项目名>/` 或 `02_<项目名>/`，避免与已有编号重复）。可选：在目录内创建 README 或占位文件。

### 步骤 3：创建项目 README（可选）

可选：在项目根目录创建 `README.md` 文件，包含项目基本信息：

```markdown
# <项目名称>

**创建时间**：YYYY-MM-DD HH:MM:SS

## 项目简介

（待补充）

## 项目结构

- `manual/` - 受保护区：项目金标准、架构决策（AI 只读，人工维护）
- 项目根目录 - 其他项目文件直接放在项目根目录下

---

*此项目由 PKM 系统自动创建*
```

### 步骤 4：输出确认

```text
✅ 项目已创建

📁 目录：20_Areas/Projects/01_XXX/
📅 时间：2026-01-13 14:30:00
📂 结构：
   └── manual/
```

---

## 操作 2：列出项目 (`@pkm project ls`)

### 步骤 1：扫描项目目录

扫描 `20_Areas/Projects/` 下的所有项目目录，获取项目信息。

### 步骤 2：获取项目详情

对每个项目，获取以下信息：
- 项目名称（从目录名提取）
- 创建时间
- 最后修改时间
- 是否有 `COMPLETED.md`（标记为已完成）
- 最新进展文件（PROCESS_*.md）

### 步骤 3：格式化输出

```text
📁 活跃项目列表

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 20260113_143000_用户认证系统
   创建时间：2026-01-13 14:30:00
   最后更新：2026-01-13 16:00:00
   状态：进行中
   最新进展：已实现用户注册功能

2. 20260113_150000_电商首页优化
   创建时间：2026-01-13 15:00:00
   最后更新：2026-01-13 17:30:00
   状态：进行中
   最新进展：完成首屏性能优化

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 提示：
  - 使用 @pkm project add <名称> 创建新项目
  - 使用 @pkm project delete <project_name> 删除项目
```

---

## 操作 3：删除项目 (`@pkm project delete <project_name>`)

### 步骤 1：查找项目

在 `20_Areas/Projects/` 中查找指定项目（支持目录名或项目名关键词）。若匹配多个，列出让用户选择。

### 步骤 2：确认删除

```text
⚠️ 确认删除项目？

📋 项目：01_XXX
📂 路径：20_Areas/Projects/01_XXX/

⚠️ 警告：此操作不可恢复！

输入 "yes" 确认删除，或直接回车取消
```

### 步骤 3：删除项目

从 `20_Areas/Projects/` 中删除该项目目录及所有内容。

### 步骤 4：输出确认

```text
✅ 项目已删除

📋 项目：20260113_143000_XXX
```

---

## 安全机制

### 路径验证

- ✅ 只在 `20_Areas/Projects/` 下创建/读取/删除项目
- ❌ 禁止操作知识库外的任何路径

---

## 关键原则

1. **职责单一**：仅管理长期项目容器（add/delete/ls），任务归档与知识回流由 _TaskManager 的 task archive 完成
2. **安全第一**：严格验证路径，防止越界操作

---

## 预期效果

通过 ProjectManager，用户可以：

- ✅ 在 20_Areas/Projects/ 下添加新的长期项目
- ✅ 列出所有长期项目
- ✅ 删除不需要的项目
