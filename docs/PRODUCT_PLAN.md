# PKM 产品化完整设计方案

> 版本：v1.0
> 日期：2026-02-27
> 作者：孙启元
> 状态：初稿

---

## 一、产品愿景与定位

### 1.1 产品名称建议

| 方案 | 名称 | 定位 | 特点 |
|------|------|------|------|
| 方案一 | **PKM Plus** | AI 驱动的个人知识管理系统 | 强调 AI 能力升级 |
| 方案二 | **NoteHub** | 知识中心 | 强调知识汇聚与连接 |
| 方案三 | **MemoFlow** | 思维流知识管理 | 强调思维流动与整理 |
| 方案四 | **QKnow** | 启元的知识引擎 | 强调个人品牌，简洁好记 |

**推荐名称**：**PKM Plus**（保留原品牌认知，强调升级）

### 1.2 目标用户

| 用户类型 | 核心需求 | 价值主张 |
|----------|----------|----------|
| 知识工作者 | 高效捕获、整理、复用知识 | AI 辅助知识管理，自动化提炼 |
| 开发者 | 代码片段、项目文档、知识沉淀 | 与 IDE 无缝集成，智能整理 |
| 学生/研究者 | 论文笔记、学习资料管理 | 双向链接、知识图谱、间隔重复 |
| 终身学习者 | 持续学习、知识体系建设 | AI 辅助提炼，形成个人知识体系 |

### 1.3 核心价值主张

**一句话定位**：AI 驱动的本地优先个人知识管理系统，让知识从捕获到提炼全自动。

**核心价值**：

1. **AI 自动化**：延续现有 PKM 的 AI 驱动理念，从捕获到提炼全流程自动化
2. **本地优先**：所有数据存储本地，保护隐私，支持离线使用
3. **渐进式提炼**：基于 CODE 方法论，实现从碎片到经验的渐进式知识沉淀
4. **任务驱动**：任务与知识库无缝连接，工作成果自动回流为知识资产

---

## 二、产品功能规划

### 2.1 核心功能（继承现有 PKM 能力）

这些功能是 PKM 的核心竞争力，需要完整迁移到独立产品中：

| 功能模块 | 功能描述 | 对应原 PKM 能力 |
|----------|----------|------------------|
| **快速捕获** | 快速记录想法、链接、内容到 Inbox | `@pkm inbox` |
| **智能组织** | 自动分类整理 50_Raw/ 中的内容 | `@pkm organize` |
| **知识提炼** | 自动从零散笔记提炼为结构化知识 | `@pkm distill` |
| **智能咨询** | 基于知识库回答问题，提供建议 | `@pkm advice` |
| **任务管理** | 4 象限任务管理，任务空间，自动归档回流 | `@pkm task` |
| **项目管理** | 长期项目维护，知识回流接收 | `@pkm project` |
| **知识检索** | 全文搜索、标签搜索、双链查询 | 新增 |

### 2.2 界面功能（需要新增的 UI 功能）

| 功能模块 | 功能描述 | 优先级 |
|----------|----------|--------|
| **PARA 导航** | 侧边栏展示 10-50 目录结构，点击可浏览 | P0 |
| **编辑器** | Markdown 编辑器，支持实时预览、块编辑 | P0 |
| **命令面板** | 快捷键唤起命令输入，类似 Notion/VS Code | P0 |
| **任务看板** | 4 象限任务可视化视图 | P1 |
| **知识图谱** | 全局/局部双向链接可视化 | P1 |
| **时间线视图** | 按时间查看笔记/任务历史 | P2 |
| **白板视图** | 视觉化整理知识（参考 Heptabase） | P2 |
| **设置面板** | 配置数据目录、主题、快捷键等 | P0 |
| **状态面板** | 显示 PKM 运行状态、知识库概况 | P1 |

### 2.3 MVP 功能列表

**MVP（最小可行产品）定义**：保留核心 PKM 能力，具备基本可用界面，不依赖 IDE 即可独立运行。

| 功能 | 优先级 | 说明 |
|------|--------|------|
| 桌面客户端运行 | P0 | 独立 .exe/.app，不依赖 Cursor/IDE |
| PARA 目录浏览 | P0 | 侧边栏展示 10-50 结构，双击打开 |
| Markdown 编辑器 | P0 | 读写 .md 文件，支持预览 |
| 快速捕获入口 | P0 | 快捷键/按钮快速添加内容到 Inbox |
| 主流程执行 | P0 | 一键执行 Verify→Organize→Distill |
| 任务管理 UI | P1 | 4 象限任务列表、添加、查看详情 |
| 命令面板 | P1 | 快捷键 Ctrl+K 唤起，执行 PKM 命令 |
| 搜索功能 | P1 | 全文搜索知识库 |
| 设置页面 | P1 | 配置数据目录、主题等 |
| 状态显示 | P2 | 显示知识库概况、上次运行报告 |

---

## 三、技术架构方案

### 3.1 技术选型

#### 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **Electron** | 生态成熟，Node.js 支持好，插件丰富 | 包体积大 (~150MB+)，内存占用高 | 需要复杂插件系统 |
| **Tauri** | 轻量 (~10MB)，Rust 后端安全，性能好 | 生态较新，插件生态待发展 | 轻量优先，安全性要求高 |
| **WebContainer** | 完全 Web 环境，无需安装 | 功能受限，浏览器沙盒限制 | 纯 Web 体验 |

#### 推荐方案：**Electron + React + TypeScript**

**理由**：
1. 现有 PKM Skill 基于文件系统操作，Electron 的 Node.js 集成更方便
2. 与 Cursor 使用的技术栈一致，便于后续能力复用
3. 成熟的桌面应用生态，插件系统可参考 Obsidian
4. 开发团队已有 Electron + React + TypeScript 经验

#### 技术栈

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| 框架 | Electron 28+ | 桌面应用框架 |
| 前端 | React 18 + TypeScript 5 | UI 框架 |
| 构建 | Vite | 快速开发构建 |
| 状态管理 | Zustand / Redux Toolkit | 应用状态管理 |
| 路由 | React Router 6 | 页面路由 |
| Markdown 编辑器 | CodeMirror 6 / Monaco | 代码/文本编辑器 |
| 文件系统 | Node.js fs + chokidar | 文件监听与操作 |
| AI 集成 | OpenAI API / Claude API | AI 能力接入 |
| UI 组件库 | Radix UI / shadcn/ui | 无样式组件库 |
| 样式 | Tailwind CSS | 原子化 CSS |
| 图谱可视化 | D3.js / React Force Graph | 知识图谱 |

### 3.2 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        PKM Plus 客户端                          │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                     UI 层 (React)                        │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐    │   │
│  │  │ 侧边栏   │ │ 编辑器   │ │ 命令面板  │ │ 设置页面  │    │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                  业务逻辑层 (Services)                   │   │
│  │  ┌────────────┐ ┌────────────┐ ┌────────────┐           │   │
│  │  │ PKM Service│ │ Task Service│ │Search Service│         │   │
│  │  │ - inbox()  │ │ - add()    │ │ - search() │           │   │
│  │  │ - organize()│ │ - done()   │ │ - query()  │           │   │
│  │  │ - distill() │ │ - archive()│ │           │           │   │
│  │  │ - advice() │ │            │ │           │           │   │
│  │  └────────────┘ └────────────┘ └────────────┘           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   AI 适配层 (AI Adapter)                 │   │
│  │  ┌────────────┐ ┌────────────┐ ┌────────────┐           │   │
│  │  │OpenAI适配器│ │Claude适配器│ │ 自定义适配器│           │   │
│  │  └────────────┘ └────────────┘ └────────────┘           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                 平台集成层 (Platform)                    │   │
│  │  ┌────────────┐ ┌────────────┐ ┌────────────┐           │   │
│  │  │文件系统操作│ │ 系统托盘   │ │ 全局快捷键 │           │   │
│  │  │  (Node.js) │ │ (Tray)    │ │ (Global)   │           │   │
│  │  └────────────┘ └────────────┘ └────────────┘           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                            ↓                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                     数据层 (Data)                        │   │
│  │  ┌─────────────────────────────────────────────────┐    │   │
│  │  │            本地文件系统 (~/.pkm/data)           │    │   │
│  │  │  10_Tasks/  20_Areas/  30_Resources/            │    │   │
│  │  │  40_Archives/  50_Raw/                        │    │   │
│  │  └─────────────────────────────────────────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 3.3 模块划分

| 模块 | 职责 | 关键技术 |
|------|------|----------|
| **App 模块** | Electron 主进程管理、窗口、托盘、快捷键 | Electron Main Process |
| **UI 模块** | React 组件、页面、路由 | React + TypeScript |
| **PKM Core 模块** | 复现现有 PKM Skill 的核心逻辑 | TypeScript |
| **File Service** | 文件系统读写、监听、解析 | Node.js fs, chokidar |
| **AI Service** | AI 对话、总结、提炼 | OpenAI/Claude API |
| **Search Service** | 全文搜索、索引 | FlexSearch / Fuse.js |
| **Task Service** | 任务 CRUD、状态管理 | TypeScript |
| **Graph Service** | 双向链接解析、图谱生成 | D3.js |

---

## 四、界面设计方案

### 4.1 整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│ PKM Plus                                    [_] [□] [X]        │
├────────────┬────────────────────────────────────────────────────┤
│            │  🔍 搜索... (Ctrl+K)                              │
│  📁 10_Tasks │──────────────────────────────────────────────────│
│    └─ 今日任务 │                                               │
│    └─ 进行中   │                                               │
│            │                                                   │
│  🧠 20_Areas │              主内容区域                          │
│    └─ Projects│              (编辑器/看板/图谱)                  │
│    └─ knowledge│                                               │
│            │                                                   │
│  📚 30_Resources│                                               │
│            │                                                   │
│  🗄️ 40_Archives│                                               │
│            │                                                   │
│  📥 50_Raw │                                                   │
│            │                                                   │
│            ├────────────────────────────────────────────────────┤
│  ─────────  │  💬 AI 对话 / 📊 状态                            │
│  ⚙️ 设置   │                                                   │
└────────────┴────────────────────────────────────────────────────┘
```

**布局说明**：
- **左侧边栏**（220px，可折叠）：PARA 目录导航，层级树形结构
- **顶部栏**（48px）：搜索入口、命令面板快捷键
- **主内容区**（flex）：根据当前视图显示不同内容
- **底部面板**（可展开）：AI 对话 / 状态信息

### 4.2 核心流程交互设计

#### 4.2.1 快速捕获流程

```
用户点击 "+" 按钮 或 按 Ctrl+N
        ↓
┌─────────────────────────────────────┐
│  快速捕获弹窗                        │
│  ┌───────────────────────────────┐  │
│  │ 输入内容或粘贴链接...          │  │
│  │                               │  │
│  │ [ ] 解析链接内容              │  │
│  └───────────────────────────────┘  │
│          [取消]  [捕获]              │
└─────────────────────────────────────┘
        ↓
   保存到 50_Raw/inbox/
        ↓
┌─────────────────────────────────────┐
│  捕获成功 ✓                          │
│  文件名: 20260227_230000_标题_inbox │
│  [查看] [继续捕获]                   │
└─────────────────────────────────────┘
```

#### 4.2.2 主流程执行（Verify → Organize → Distill）

```
用户点击 "执行主流程" 按钮 或 @pkm 命令
        ↓
┌─────────────────────────────────────────────────────────────┐
│  PKM 执行中...                                              │
│                                                             │
│  ✅ Verify: 验证目录结构                                    │
│     └─ 5 个顶级目录检查完成                                  │
│                                                             │
│  🗄️ Archive: 归档已完成任务                                  │
│     └─ 扫描任务空间...                                      │
│     └─ 0 个任务需要归档                                      │
│                                                             │
│  📦 Organize: 整理 50_Raw/                                  │
│     └─ 发现 3 个待处理文件                                  │
│     └─ [██████░░░░] 正在分类...                             │
│                                                             │
│  💎 Distill: 提炼知识                                       │
│     └─ [████████░░] 深度整合中...                           │
│                                                             │
│  ─────────────────────────────────────                      │
│  执行结果摘要:                                               │
│  • 整理知识: 3 → 20_Areas/knowledge/03notes/               │
│  • 提炼知识: 5 个文件已更新                                 │
│  • 生成报告: 20260227_230000_提炼报告_Distill.md           │
│                                                             │
│                         [关闭]                               │
└─────────────────────────────────────────────────────────────┘
```

#### 4.2.3 任务看板视图

```
┌─────────────────────────────────────────────────────────────────┐
│  任务看板                                          [+ 添加任务] │
├────────────┬────────────┬────────────┬────────────┬────────────┤
│ 🔴 重要    │ 🟡 重要    │ 🟠 紧急    │ 🟢 不重要  │            │
│   且紧急   │  且不紧急  │  且不重要  │  且不紧急  │            │
│            │            │            │            │            │
│ ┌────────┐ │ ┌────────┐ │ ┌────────┐ │ ┌────────┐ │            │
│ │T-001   │ │ │T-002   │ │ │T-003   │ │ │T-004   │ │            │
│ │任务A   │ │ │任务B   │ │ │任务C   │ │ │任务D   │ │            │
│ │2天后   │ │ │5天后   │ │ │今天    │ │ │7天后   │ │            │
│ └────────┘ │ └────────┘ │ └────────┘ │ └────────┘ │            │
│            │            │            │            │            │
│ [+ 添加]   │ [+ 添加]   │ [+ 添加]   │ [+ 添加]   │            │
└────────────┴────────────┴────────────┴────────────┴────────────┘
```

#### 4.2.4 知识图谱视图

```
┌─────────────────────────────────────────────────────────────────┐
│  知识图谱                                    [全局] [当前文档]   │
│                                                         [🔍]   │
│                                                              │
│        ○ ─────── ○                                              │
│       /│\       /│                                              │
│      ○ ○ ○     ○ ○                                              │
│       \│/       │                                               │
│        ○ ────── ○                                                │
│       /                                                │
│      ○                                                   │
│                                                              │
│  ─────────────────────────────────────────────────────────     │
│  选中节点: 20_Areas/knowledge/03notes/Python/异步编程.md      │
│  引用: 3 个文档                                              │
│  被引用: 5 个文档                                             │
│  标签: #python #async                                         │
│                                                              │
│  [在编辑器中打开] [查看反向链接]                               │
└─────────────────────────────────────────────────────────────────┘
```

### 4.3 关键页面原型描述

#### 4.3.1 主页面（仪表盘）

**入口**：启动应用后的默认页面

**内容**：
- 欢迎信息 + 今日概览
- 待办任务列表（4 象限各显示 1-2 个）
- 最近捕获的 Inbox 内容
- 最近提炼的报告
- 快捷操作按钮：「快速捕获」「执行主流程」「查看知识图谱」

#### 4.3.2 目录浏览页面

**入口**：点击侧边栏任意 PARA 目录

**内容**：
- 目录树形结构
- 文件/文件夹列表（支持排序：名称/修改时间）
- 右键菜单：打开/重命名/移动/删除
- 拖拽支持：拖拽文件到其他目录

#### 4.3.3 编辑器页面

**入口**：双击任意 .md 文件

**功能**：
- Markdown 语法高亮
- 实时预览（分屏/切换）
- 块级操作（选中、拖拽、移动）
- 双链支持：`[[文档名]]` 自动补全
- 标签支持：`#tag` 自动补全
- 行号显示
- 大纲目录

#### 4.3.4 任务详情页面

**入口**：点击任务看板中的任务卡

**内容**：
- 任务元数据（ID、4 象限、计划时间、工作量）
- 任务描述/目标
- 进展记录（时间线）
- 关联项目
- 操作按钮：编辑/更新进展/完成

#### 4.3.5 设置页面

**入口**：点击左下角设置图标

**内容**：
- **通用**：数据目录选择、主题（亮/暗/跟随系统）
- **快捷键**：自定义快捷键配置
- **AI**：选择 AI 提供商、API Key 配置
- **同步**：云同步配置（可选）
- **关于**：版本信息、检查更新

---

## 五、实施路线图

### 5.1 阶段划分

#### 第一阶段：基础框架（MVP）

**目标**：搭建可运行的桌面客户端，实现核心读写功能

**时间**：2-3 周

| 序号 | 任务 | 说明 |
|------|------|------|
| 1.1 | Electron 项目初始化 | Vite + React + TypeScript 脚手架 |
| 1.2 | 主窗口框架 | 侧边栏 + 主内容区布局 |
| 1.3 | 文件系统服务 | 读取、写入、监听文件变化 |
| 1.4 | PARA 目录树 | 侧边栏显示 10-50 目录结构 |
| 1.5 | Markdown 编辑器 | CodeMirror 集成，基本编辑功能 |
| 1.6 | 设置页面 | 数据目录配置、主题切换 |
| 1.7 | 应用打包 | 生成可运行的 .exe |

**里程碑**：用户可以启动应用、浏览目录、编辑 Markdown 文件

#### 第二阶段：核心功能

**目标**：实现 PKM 核心业务流程的 UI 化

**时间**：3-4 周

| 序号 | 任务 | 说明 |
|------|------|------|
| 2.1 | 快速捕获 UI | 弹窗输入，保存到 Inbox |
| 2.2 | 主流程执行器 | 完整的 Verify→Organize→Distill 流程 |
| 2.3 | 任务管理 UI | 任务看板、4 象限视图 |
| 2.4 | 命令面板 | Ctrl+K 唤起，执行 PKM 命令 |
| 2.5 | 搜索功能 | 全文搜索、结果高亮 |
| 2.6 | 状态面板 | 显示 PKM 运行状态、知识库概况 |

**里程碑**：用户可以完成完整的 PKM 工作流，无需打开 IDE

#### 第三阶段：增强功能

**目标**：提升用户体验，增加高级功能

**时间**：2-3 周

| 序号 | 任务 | 说明 |
|------|------|------|
| 3.1 | 知识图谱 | 双向链接解析、D3.js 可视化 |
| 3.2 | AI 对话 | 集成 OpenAI/Claude API |
| 3.3 | 系统托盘 | 最小化到托盘、快速捕获 |
| 3.4 | 全局快捷键 | 随时唤起快速捕获 |
| 3.5 | 导出功能 | 导出 PDF/HTML/JSON |

**里程碑**：具备与主流 PKM 工具相当的竞争力

#### 第四阶段：生态扩展（可选）

**目标**：开放插件系统，形成生态

**时间**：持续迭代

| 序号 | 任务 | 说明 |
|------|------|------|
| 4.1 | 插件系统 | 参考 Obsidian 插件 API |
| 4.2 | 主题系统 | 主题市场、主题编辑器 |
| 4.3 | 移动端 | iOS/Android 应用 |
| 4.4 | 同步服务 | 跨设备同步（可选） |

### 5.2 里程碑总结

| 阶段 | 里程碑 | 预计时间 |
|------|--------|----------|
| MVP | 可独立运行的桌面客户端，核心读写功能 | 2-3 周 |
| 核心功能 | 完整 PKM 工作流 UI 化 | 3-4 周 |
| 增强功能 | 知识图谱、AI 对话、系统集成 | 2-3 周 |
| 生态 | 插件系统、移动端、跨设备同步 | 持续迭代 |

### 5.3 优先级排序

**功能优先级（P0-P3）**：

```
P0 (必须实现):
├── 桌面客户端运行
├── PARA 目录浏览
├── Markdown 编辑器
├── 快速捕获
├── 主流程执行
└── 设置页面

P1 (重要功能):
├── 任务管理 UI
├── 命令面板
├── 搜索功能
├── 状态显示
└── AI 集成

P2 (增强功能):
├── 知识图谱
├── 系统托盘
├── 全局快捷键
├── 时间线视图
└── 导出功能

P3 (未来规划):
├── 插件系统
├── 主题系统
├── 移动端
└── 同步服务
```

---

## 六、风险与对策

### 6.1 技术风险

| 风险 | 影响 | 对策 |
|------|------|------|
| Electron 包体积大 | 用户下载门槛高 | 考虑 Tauri 方案作为备选 |
| AI API 成本 | 持续运行成本 | 提供本地模型选项、支持用户配置 API |
| 文件同步冲突 | 多端编辑冲突 | 参考 SiYuan 的冲突处理机制 |

### 6.2 产品风险

| 风险 | 影响 | 对策 |
|------|------|------|
| 功能与现有 Skill 行为不一致 | 用户迁移成本 | 保持核心逻辑与原 PKM 一致 |
| 用户学习成本 | 新用户上手难度 | 提供引导教程、预设模板 |

---

## 七、附录

### 7.1 参考产品特性对比

| 产品 | 技术栈 | 本地优先 | 双链 | AI | 插件系统 | 许可证 |
|------|--------|----------|------|-----|----------|--------|
| Obsidian | Electron | ✅ | ✅ | ❌ | ✅ | 闭源 |
| Logseq | Electron + Clojure | ✅ | ✅ | ❌ | ✅ | 开源 |
| SiYuan | Electron + Go | ✅ | ✅ | ✅ | ✅ | 开源 |
| Notion | Electron | ❌ | ✅ | ✅ | ❌ | 闭源 |
| RemNote | Electron | ✅ | ✅ | ✅ | ✅ | 闭源 |
| Heptabase | React | ❌ | ✅ | ❌ | ❌ | 闭源 |
| **PKM Plus** | **Electron + React** | **✅** | **✅** | **✅** | **待实现** | **待定** |

### 7.2 文件结构设计

```
pkm-plus/
├── src/
│   ├── main/                 # Electron 主进程
│   │   ├── index.ts         # 入口
│   │   ├── ipc.ts          # IPC 通信
│   │   ├── tray.ts         # 系统托盘
│   │   └── shortcuts.ts    # 全局快捷键
│   ├── renderer/            # React 前端
│   │   ├── App.tsx         # 根组件
│   │   ├── components/     # UI 组件
│   │   ├── pages/          # 页面
│   │   ├── services/       # 业务服务
│   │   ├── hooks/          # React Hooks
│   │   ├── stores/         # 状态管理
│   │   └── styles/         # 样式
│   ├── core/               # PKM 核心逻辑
│   │   ├── pkm/            # PKM 主逻辑
│   │   ├── task/           # 任务管理
│   │   ├── file/           # 文件操作
│   │   └── ai/             # AI 适配
│   └── shared/             # 共享类型/工具
├── resources/              # 静态资源
├── package.json
├── electron-builder.json
├── vite.config.ts
└── tsconfig.json
```

---

**文档结束**

> 本方案为 PKM 产品化的完整设计蓝图，可作为后续开发的指导文档。方案将根据实际开发进展持续迭代更新。
